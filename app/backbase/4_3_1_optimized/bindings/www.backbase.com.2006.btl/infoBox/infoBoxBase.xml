<?xml version="1.0" encoding="UTF-8"?><d:tdl xmlns="http://www.w3.org/1999/xhtml" xmlns:b="http://www.backbase.com/2006/btl" xmlns:bb="http://www.backbase.com/2006/client" xmlns:d="http://www.backbase.com/2006/tdl"><d:namespace name="http://www.backbase.com/2006/btl"><d:uses element="dimensionElement containerElement" src="../visualElement/visualElement.xml"/><d:element name="infoBoxBase" extends="b:dimensionElement b:containerElement" abstract="true"><d:resource type="text/javascript"><![CDATA[if(!window.btl){window.btl={};}btl.infoBoxBase={};btl.infoBoxBase.current=null;btl.infoBoxBase.handleMouseDown=function btl_infoBox_handleMouseDown(eEvent){if(btl.infoBoxBase.current!=null){var bInsideBox=false;var oElement=eEvent.target;while(oElement&&!bInsideBox){if(oElement==btl.infoBoxBase.current){bInsideBox=true;break;}oElement=oElement.getProperty('parentNode');}if(!bInsideBox){btl.infoBoxBase.current.close();}}};btl.infoBoxBase.handleKeyDown=function btl_infoBox_handleKeyDown(eEvent){if(btl.infoBoxBase.current!=null){if(eEvent.keyIdentifier=='U+001B'){btl.infoBoxBase.current.close();}else{var bInsideBox=false;var oElement=eEvent.target;var oTrigger=btl.infoBoxBase.current.getProperty('listeners');while(oElement&&!bInsideBox){if(oElement==btl.infoBoxBase.current||bb.array.indexOf(oTrigger,oElement)!=-1){bInsideBox=true;break;}oElement=oElement.getProperty('parentNode');}if(!bInsideBox){btl.infoBoxBase.current.close();}}}};btl.infoBoxBase.handleOpen=function btl_infoBoxBase_handleOpen(eEvent){var oElm=eEvent.currentTarget;if(oElm._.__infoBox){oElm._.__infoBox.open(oElm);}};]]></d:resource><d:attribute name="open"><d:changer type="text/javascript"><![CDATA[if(btl.isTrueValue(name,value)){this.open();}else{this.close();}]]></d:changer></d:attribute><d:attribute name="for" default=".."><d:changer type="text/javascript"><![CDATA[var sFor=this.getAttribute('for');var aListeners=bb.document.evaluate(sFor,this);this.setProperty('listeners',aListeners);]]></d:changer></d:attribute><d:property name="listeners"><d:setter type="text/javascript"><![CDATA[if(this._._listeners){this.removeHandlersFromListeners(this._._listeners);}this._._listeners=value;this.addHandlersToListeners(this._._listeners);]]></d:setter></d:property><d:property name="open"><d:setter type="text/javascript"><![CDATA[if(value){this.open();}else{this.close();}]]></d:setter><d:getter type="text/javascript"><![CDATA[if(this._['_open']===undefined){this._['_open']=btl.isTrueValue('open',this.getAttribute('open'));}return this._['_open'];]]></d:getter></d:property><d:method name="removeHandlersFromListeners"><d:argument name="listeners"/><d:body type="text/javascript"><![CDATA[for(var i=0,iMax=listeners.length;iMax>i;i++){listeners[i]._.__infoBox=null;listeners[i].removeEventListener('click',btl.infoBoxBase.handleOpen,false);listeners[i].removeEventListener('DOMActivate',btl.infoBoxBase.handleOpen,false);}]]></d:body></d:method><d:method name="addHandlersToListeners"><d:argument name="listeners"/><d:body type="text/javascript"><![CDATA[for(var i=0,iMax=listeners.length;iMax>i;i++){listeners[i]._.__infoBox=this;listeners[i].addEventListener('click',btl.infoBoxBase.handleOpen,false);listeners[i].addEventListener('DOMActivate',btl.infoBoxBase.handleOpen,false);}]]></d:body></d:method><d:method name="open"><d:argument name="destination"/><d:body type="text/javascript"><![CDATA[if(btl.infoBoxBase.current&&btl.infoBoxBase.current!=this){btl.infoBoxBase.current.close();}if(destination===undefined){destination=this.getProperty('listeners')[0];}if(destination&&!this._['_open']){btl.infoBoxBase.current=this;bb.document.addEventListener('mousedown',btl.infoBoxBase.handleMouseDown,true);bb.document.addEventListener('keydown',btl.infoBoxBase.handleKeyDown,true);this.modelNode.setAttribute('open','true');this._['_open']=true;bb.command.fireEvent(this,'open',false,false);return true;}]]></d:body></d:method><d:method name="close"><d:body type="text/javascript"><![CDATA[if(this._['_open']){btl.infoBoxBase.current=null;bb.document.removeEventListener('mousedown',btl.infoBoxBase.handleMouseDown,true);bb.document.removeEventListener('keydown',btl.infoBoxBase.handleKeyDown,true);this.modelNode.setAttribute('open','false');this._['_open']=false;bb.command.fireEvent(this,'close',false,false);}]]></d:body></d:method><d:destructor type="text/javascript"><![CDATA[this.close();var aContext=this.getProperty('listeners');for(var i=0,iMax=aContext.length;iMax>i;i++){if(aContext[i]){if(aContext[i]._){aContext[i]._.__infoBox=null;aContext[i].removeEventListener('click',btl.infoBoxBase.handleOpen,false);aContext[i].removeEventListener('DOMActivate',btl.infoBoxBase.handleOpen,false);}}}]]></d:destructor><d:handler event="construct" type="text/javascript"><![CDATA[bb.ui.reflow.add(this);]]></d:handler><d:handler event="DOMNodeInsertedIntoDocument" type="text/javascript"><![CDATA[var sFor=this.getAttribute('for');var aListeners=bb.document.evaluate(sFor,this);this.setProperty('listeners',aListeners);]]></d:handler><d:handler event="reflow" type="text/javascript"><![CDATA[if(btl.isTrueValue('open',this.getAttribute('open'))){this.open();}]]></d:handler></d:element></d:namespace></d:tdl>